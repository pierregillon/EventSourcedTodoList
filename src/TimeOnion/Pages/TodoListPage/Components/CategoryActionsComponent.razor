@using TimeOnion.Domain.Categories
@using BlazorState
@inherits BlazorStateComponent
@inject IDialogService DialogService

<MudMenu
    Class="@Class"
    Icon="@Icons.Material.Filled.MoreHoriz"
    Size="Size.Small"
    AnchorOrigin="Origin.BottomCenter">

    <MudMenuItem
        Icon="@Icons.Material.Filled.Delete"
        IconColor="Color.Warning"
        OnClick="ConfirmDeletion"
        OnTouch="ConfirmDeletion">
        Supprimer
    </MudMenuItem>

</MudMenu>

@code {

    [Parameter]
    public CategoryReadModel Category { get; set; } = default!;

    [Parameter]
    public string Class { get; set; } = string.Empty;

    private Task Send(IAction action) => Mediator.Send(action);

    private async Task ConfirmDeletion()
    {
        if (await DialogService.ShowConfirmationDialog("Confirmation", $"Êtes-vous sûr de vouloir supprimer la catégorie \"{Category.Name}\" ? Ses tâches seront conservées."))
        {
            await Send(new TodoListState.DeleteCategory(Category.Id, Category.ListId));
        }
    }

}